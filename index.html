<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Mochi AI</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{height:100vh;overflow:hidden;background:#fff;}

/* Sao + tim bay */
.float{position:absolute;font-size:14px;animation:fly 6s infinite ease-in-out;opacity:0.6;}
@keyframes fly{0%{transform:translateY(0)}50%{transform:translateY(-30px)}100%{transform:translateY(0)}}

/* Modal c∆° b·∫£n */
.modal{position:fixed;inset:0;display:none;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:50;}
.modal-content{background:#fff;color:#333;width:90%;max-width:400px;border-radius:20px;padding:20px;box-shadow:0 0 30px rgba(0,0,0,0.2);}
.modal-content h3{text-align:center;color:#ff6fa7;margin-bottom:10px;}
.modal-content button{background:#ff6fa7;color:#fff;padding:10px 18px;border-radius:18px;font-weight:600;cursor:pointer;}
.modal-content button.close{background:#aaa;margin-left:10px;}

/* Chat */
#chat{position:fixed;inset:0;display:none;background:linear-gradient(180deg,#ffe6f1,#fff);flex-direction:column;}
.chat-header{padding:14px;background:#fff;box-shadow:0 3px 10px rgba(255,150,190,.3);text-align:center;font-weight:700;color:#ff6fa7;}
.chat-box{flex:1;padding:14px;overflow-y:auto;font-size:14px;color:#444;}
.msg{background:#fff;padding:10px 14px;border-radius:18px;margin-bottom:10px;width:fit-content;max-width:80%;box-shadow:0 0 12px rgba(255,150,190,.25);}
.msg.char{border-top-left-radius:6px;}
.msg.user{margin-left:auto;background:#ff6fa7;color:#fff;border-top-right-radius:6px;}
.input{display:flex;padding:10px;gap:8px;}
.input input{flex:1;border:none;padding:10px;border-radius:18px;outline:none;box-shadow:0 0 8px rgba(255,150,190,.3);}
.input button{background:#ff6fa7;border:none;color:#fff;padding:0 16px;border-radius:18px;cursor:pointer;}

/* Card char */
#chars{position:fixed;inset:0;display:none;background:linear-gradient(180deg,#ffe0ef,#fff);overflow-y:auto;padding-bottom:30px;}
.char-header{text-align:center;padding:14px;font-weight:700;color:#ff6fa7;background:#fff;box-shadow:0 3px 10px rgba(255,150,190,.3);}
.flower-count{font-size:13px;margin-top:4px;}
.list{padding:14px;display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}
.card{background:#fff;border-radius:18px;overflow:hidden;box-shadow:0 6px 18px rgba(255,120,180,.3);position:relative;cursor:pointer;}
.card img{width:100%;height:160px;object-fit:cover;}
.name{text-align:center;padding:8px;color:#ff6fa7;font-weight:600;}
.lock{position:absolute;inset:0;background:rgba(255,210,230,.85);display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:13px;color:#ff4f90;}
.task-btn{position:absolute;bottom:8px;right:8px;background:#ff6fa7;color:#fff;padding:6px 10px;border-radius:12px;font-size:12px;font-weight:600;cursor:pointer;}
.thought-icon{position:absolute;top:6px;right:6px;font-size:18px;cursor:pointer;}

/* Daily */
#daily{position:fixed;inset:0;display:none;background:linear-gradient(180deg,#ffd1e6,#fff);align-items:center;justify-content:center;z-index:9;}
.daily-board{width:90%;max-width:360px;background:#fff;border-radius:26px;padding:22px;box-shadow:0 0 40px rgba(255,120,180,.45);}
.claim{background:#ff6fa7;color:#fff;padding:12px;text-align:center;border-radius:20px;font-weight:600;animation:blink 1.3s infinite;cursor:pointer;}

/* Phone char */
#phoneChar{position:fixed;inset:0;display:none;background:linear-gradient(180deg,#ffe6f1,#fff);flex-direction:column;overflow-y:auto;}
.phone-header{padding:14px;background:#fff;box-shadow:0 3px 10px rgba(255,150,190,.3);text-align:center;font-weight:700;color:#ff6fa7;}
.phone-content{padding:14px;}
.phone-section{margin-bottom:14px;}
.phone-section h4{color:#ff6fa7;margin-bottom:6px;}
.phone-section div{background:#fff;padding:8px;border-radius:12px;margin-bottom:4px;box-shadow:0 0 6px rgba(255,120,180,.2);}
</style>
</head>
<body>

<script>
// Sao + tim bay
const icons=["‚ú®","‚≠ê","üíó","üå∏"];
for(let i=0;i<30;i++){
  let f=document.createElement("div");
  f.className="float";
  f.innerText=icons[Math.floor(Math.random()*icons.length)];
  f.style.left=Math.random()*100+"vw";
  f.style.top=Math.random()*100+"vh";
  f.style.animationDelay=Math.random()*5+"s";
  document.body.appendChild(f);
}
</script>

<!-- NH·∫¨P T√äN -->
<div id="login" class="modal" style="display:flex;">
  <div class="modal-content">
    <h3>Ch√†o m·ª´ng ƒë·∫øn Love Mochi üíó</h3>
    <input id="playerName" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." style="width:100%;padding:10px;border-radius:12px;margin-bottom:10px;outline:none;"/>
    <input id="playerAge" placeholder="Nh·∫≠p tu·ªïi..." style="width:100%;padding:10px;border-radius:12px;margin-bottom:10px;outline:none;" type="number"/>
    <div style="text-align:center;">
      <button onclick="startGame()">B·∫Øt ƒë·∫ßu</button>
    </div>
  </div>
</div>

<!-- Char List -->
<div id="chars">
  <div class="char-header">
    üå∏ Nh√¢n v·∫≠t LOVE MOCHI
    <div class="flower-count">Hoa: <span id="flower">0</span> üå∏</div>
  </div>
  <div class="list" id="charList"></div>
</div>

<!-- Chat -->
<div id="chat">
  <div class="chat-header" id="chatName"></div>
  <div class="chat-box" id="chatBox"></div>
  <div class="input">
    <input id="chatInput" placeholder="Nh·∫≠p tin nh·∫Øn...">
    <button onclick="sendMsg()">G·ª≠i</button>
  </div>
</div>

<!-- Daily -->
<div id="daily">
  <div class="daily-board">
    <h2>üå∏ ƒêi·ªÉm danh h·∫±ng ng√†y</h2>
    <div class="claim" onclick="claimFlower()">Nh·∫≠n 10 üå∏</div>
  </div>
</div>

<!-- Task -->
<div id="task" class="modal">
  <div class="modal-content">
    <h3 id="taskName"></h3>
    <div id="taskStory"></div>
    <div style="text-align:center;margin-top:14px;">
      <button onclick="startTask()">B·∫Øt ƒë·∫ßu nhi·ªám v·ª•</button>
      <button class="close" onclick="closeTask()">ƒê√≥ng</button>
    </div>
  </div>
</div>

<!-- Phone Char -->
<div id="phoneChar">
  <div class="phone-header" id="phoneHeader"></div>
  <div class="phone-content" id="phoneContent"></div>
</div>

<script>
// ===== Khai b√°o =====
let player="", playerAge="";
let flowers=Number(localStorage.getItem("flowers")||0);
let lastClaim=localStorage.getItem("lastClaim")||"";
let unlocked=[], affection={}, currentChar="";
let charData={
  "Kael":{personality:"vui v·∫ª", mood:0, thoughts:[], messages:[], searches:[], schedule:["08:00: Cafe","10:00: L√†m vi·ªác","18:00: ƒêi d·∫°o"]},
  "Y·∫øn Tu√¢n":{personality:"tr·∫ßm l·∫Øng", mood:0, thoughts:[], messages:[], searches:[], schedule:["09:00: Th·ªÉ thao","12:00: ƒÇn tr∆∞a","20:00: Xem phim"]}
};
document.getElementById("flower").innerText=flowers;

// ===== Game Start =====
function startGame(){
  const name=document.getElementById("playerName").value.trim();
  const age=document.getElementById("playerAge").value.trim();
  if(!name||!age){alert("Nh·∫≠p ƒë·ªß t√™n v√† tu·ªïi!");return;}
  player=name; playerAge=age;
  localStorage.setItem("playerName",player);
  localStorage.setItem("playerAge",playerAge);
  document.getElementById("login").style.display="none";
  
  const today=new Date().toISOString().slice(0,10);
  if(lastClaim!==today){
    document.getElementById("daily").style.display="flex";
  }else showCharList();
}

// ===== Daily =====
function claimFlower(){
  flowers+=10;
  localStorage.setItem("flowers",flowers);
  const today=new Date().toISOString().slice(0,10);
  localStorage.setItem("lastClaim",today);
  document.getElementById("flower").innerText=flowers;
  document.getElementById("daily").style.display="none";
  showCharList();
}

// ===== Show Char List =====
function showCharList(){
  document.getElementById("chars").style.display="block";
  const list=document.getElementById("charList");
  list.innerHTML="";
  for(const name in charData){
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`<div class="name">${name}</div>`;
    const thought=document.createElement("div");
    thought.className="thought-icon"; thought.innerText="üí≠";
    thought.onclick=e=>{e.stopPropagation(); alert(charData[name].thoughts.join("\n")||"Kh√¥ng c√≥ suy nghƒ©");};
    c.appendChild(thought);
    c.onclick=()=>openChat(name);
    list.appendChild(c);
  }
}

// ===== Chat =====
function openChat(name){
  currentChar=name;
  document.getElementById("chars").style.display="none";
  document.getElementById("chat").style.display="flex";
  document.getElementById("chatName").innerText=`${name} ‚Äì Thi·ªán c·∫£m: ${affection[name]||0}`;
  const box=document.getElementById("chatBox");
  box.innerHTML=`<div class="msg char">Ch√†o ${player}! Anh l√† ${name} üíó</div>`;
}

// Fake AI tr·∫£ l·ªùi
function sendMsg(){
  const input=document.getElementById("chatInput");
  const text=input.value.trim();
  if(!text) return;
  const box=document.getElementById("chatBox");
  const userMsg=document.createElement("div"); userMsg.className="msg user"; userMsg.innerText=text; box.appendChild(userMsg);

  // Update history
  charData[currentChar].messages.push({from:"player", text});
  
  // Update thi·ªán c·∫£m
  affection[currentChar]=(affection[currentChar]||0)+1;
  localStorage.setItem("affection",JSON.stringify(affection));
  document.getElementById("chatName").innerText=`${currentChar} ‚Äì Thi·ªán c·∫£m: ${affection[currentChar]}`;

  // Fake AI reply
  const reply=document.createElement("div"); reply.className="msg char";
  const responses=[
    `Haha ${player}, th·∫≠t vui khi em n√≥i v·∫≠y!`,
    `${player}, anh nghƒ© em th·∫≠t ƒë√°ng y√™u üòÑ`,
    `Anh th·∫•y ${player} h√¥m nay th·∫≠t tuy·ªát v·ªùi!`,
    `√îi ${player}, chuy·ªán ƒë√≥ nghe th√∫ v·ªã qu√°!`
  ];
  reply.innerText=responses[Math.floor(Math.random()*responses.length)];
  box.appendChild(reply);
  charData[currentChar].messages.push({from:"char", text:reply.innerText});
  box.scrollTop=box.scrollHeight;
  input.value="";
}

// ===== Task =====
function openTask(name){
  currentChar=name;
  document.getElementById("taskName").innerText=`Nhi·ªám v·ª• v·ªõi ${name}`;
  document.getElementById("taskStory").innerText=`H√£y tr√≤ chuy·ªán vui v·∫ª v·ªõi ${name} ƒë·ªÉ tƒÉng thi·ªán c·∫£m!`;
  document.getElementById("task").style.display="flex";
}
function closeTask(){document.getElementById("task").style.display="none";}
function startTask(){closeTask(); openChat(currentChar); alert("üéØ Nhi·ªám v·ª• b·∫Øt ƒë·∫ßu, ho√†n th√†nh s·∫Ω nh·∫≠n 10 hoa!"); flowers+=10; document.getElementById("flower").innerText=flowers; localStorage.setItem("flowers",flowers);}
</script>
</body>
  </html>
